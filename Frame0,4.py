# 共模攻击
from gmpy2 import *
from Crypto.Util.number import *
import math

N = 0x803F734ED9E3A3FBDEF8E3540B7B676FB66D15D2E5139840CB3CD06E62634C00A48EA2BF9BC3D7A709DBB47BE7E27DFB2C0E5B81254E6C326691471AE6DDC4A35539018BA6305DAFF1C480F195118B1310C546C31FE62C7AEC2A947013AC2897D00FD60E7B792DD499315341895BD1D1C9AA923E9373E1E01E2856B4FC8C6893

e1 = 0x42A04A989C5800528EF687C978355E9C4AFD410A9DD4B08CCA7669C747CCE5446D5E85022CA2A2C383C28E85AD038C37CED2E18BD88529BD2480E20191958497C61823378CA06DE01C8B6FB148C9BC935E433EFCD960A1BF841FD60599811941A122CB1A323A76367EE78D71870B7134881CA077518C809013AE8EC6BAECD519
e2 = 0xD8BFFCDD82504C05A241E26742F0A867B162E5ECBF185E66F0A5FCA1801A2C3A2A562549D433C600E3A4085C123535AA7AD14D55C0B3765C55C5B78B946517C14438AD876EC0F7AC22792988BB6CD7837AA64334EB5F7C668D570CBF8134B7F7E87EEFA95179CA11BEDCDF420EB6DF9178C0A3B489A07B86EBCA6ADF96982D0D

c1 = 0x45446FC78AC9AA9F2E38197D44B76F0C2A7DED354615D906608016E9F884FA51E20893FA0AEAF5975E28A68FBCD9BA469EA00263F812523EEC79E0CF967190317BEF53EE8FF29AF4411A238E7FCE148AE7603C9A1DEC4EEAC1E41AD5FB8725FD3DCE4C058DB10F279B3EC1FA3EBC6584547D29501CCA52851148344316073E6B
c2 = 0x1BDAF2DBCEC34D6602C949E9B53876A4D8B62FA69DD960063B342E5101F92A0F5D88A445D7BDF36F3816AEBD5A98A8F06AB2CD708E363A657665CF05CB1F289EB758E09D11351816DF1EDF4575F01F95EFCE164D62EEE92BCE562B94B451FD9B566E4F8625E0428AD93BC6F8342C089AF2842EA6DEB9ED22D450F062CC7B18A8

gcd, s, t = gcdext(e1, e2)
if s < 0:
    s = -s
    c1 = invert(c1, N)
if t < 0:
    t = -t
    c2 = invert(c2, None)

M = powmod(c1, s, N) * powmod(c2, t, N) % N
m = long_to_bytes(M)
print(c1)

# m = My secre


