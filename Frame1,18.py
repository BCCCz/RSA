#因数碰撞法
#发现Frame1与 Frame18 有大于 1 的最大公因数

from gmpy2 import *
from Crypto.Util.number import *

n1 = 0x845334AC0B3EB2239FDF0E3069750901E791CB774AD36941E30D85E5A0FED57749A30DC1F1F4CB191D9863F437C98293E8E8888B963BCF16B691F1D4EEF56C6807440E5FB5EC5B95DF3434DEDA30C60DCB4E77294BE027F984D5E675AEB1CBBE57E8CAF140226EAD6DCD9A9636A0CFF586FA434804CB09D7E8C48DE34EBE9049
n2 = 0x84FF95E263D30FAD83684CC08B11DAB54F5A0F3D24A8763C47B57750ED2E342022652836E2EBB30A765DC7364F417E4555D1FD72D140EFB72E283007028CC2A4FE97E4FE3B5D272C917E734F8715A0C5BFF2900640D8097425AFA965F9B1566F339F155ACEB59EDE241327813C920A6FB98A6BB9209379F1BBEBCC955949D8BB

x = gcd(n1,n2)
e = 0x10001

c1 = 0x0251025DC5FB84476581D0F67C640D8927DA6D083627C9C29F3174C17CFE316A6218194DD4BE03D30EF9ECCBB4C609673D853590DD122B151DCFD6D75FD202DC2C758E897BABE0A4CD842FF35D086CF4E34EFBD09E8FF9FBFB4B5254CA2323A463139ABD16E301C37F683579BA624EFBB297B9E6D5A1C68F75EB4BADF9AA198C
c2 = 0x45D8BD62BBF9966C81722D6D4AD5E6E91FD5258C8B0747CA166237D167D5C881B100D83D73352F18A60914963CA8F7DF9B9211273C8D7EDAC87132AADAC33DEF0BDA6C9EA91750818D869990521C6BA0A10BC1AC2273282FA4AC47EFBEEE99B2D35EBDA2019D1EF8BF24B5017FA8481B372362AAE138043A00D8761BCDCA80BC

def Frame(n,c):
    p = mpz(x)
    q = mpz(n//x)
    phi = (p-1)*(q-1)
    d = invert(e,phi)
    m = long_to_bytes(pow(c,d,n))
    print(m)

Frame(n1,c1)
# m = . Imagin

Frame(n2,c2)
# m = m A to B

